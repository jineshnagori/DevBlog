<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="DevBlog is the website dedicated only for true developers."
    />
    <meta name="keywords" content="DevBlog, Blogs for Developer" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/style/ionicons.min.css"
    />

    <link rel="icon" type="image/x-icon" href="assets/img/blog.png" />
    <title>DevBlog - Blog for Developers</title>
    <link rel="stylesheet" href="assets/style/style-modular.css" id="theme-sheet" />
    <link rel="stylesheet" href="assets/style/contributor-flip.css" />
  </head>
  <body>
    <div id="navbar-container">
      <noscript>
        <nav
          class="font2 navbar navbar-expand-lg navbar-light shadow-sm bg-light fixed-top"
        >
          <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="index.html">
              <span class="ml-3 font-weight-bold font2">DevBlog</span>
            </a>
            <div class="navbar-nav mx-auto">
              <a class="nav-link" href="index.html">Home</a>
              <a class="nav-link" href="about.html">About</a>
              <a class="nav-link" href="contact.html">Contact</a>
              <a class="nav-link active" href="contributors.html"
                >Contributors</a
              >
            </div>
          </div>
        </nav>
      </noscript>
    </div>

    <div class="container my-5 pt-5">
      <h2 class="text-center mb-5">Our Contributors</h2>
      <div id="contributors-container" class="row g-4">
        <!-- Contributors will be dynamically loaded here -->
      </div>
    </div>

    <!-- Footer Container -->
    <div id="footer-container">
      <!-- Footer will be loaded here by template loader -->
      <!-- Fallback footer for when JavaScript is disabled -->
      <noscript>
        <div class="footer-dark">
          <footer>
            <div class="container">
              <p class="copyright text-center">DevBlog Â© 2024</p>
            </div>
          </footer>
        </div>
      </noscript>
    </div>
  </body>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
  <script
    src="https://kit.fontawesome.com/6d2226036d.js"
    crossorigin="anonymous"
  ></script>
  <script src="assets/script/template-loader.js"></script>
  <script src="assets/script/common.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", async function () {
      await templateLoader.loadMultipleTemplates([
        { path: "templates/navbar.html", target: "#navbar-container" },
        { path: "templates/footer.html", target: "#footer-container" },
      ]);
      DevBlog.init("contributors");
    });
  </script>

  <script type="module">
    import { Octokit } from "https://cdn.pika.dev/@octokit/core@1.3.2";
    const octokit = new Octokit();

    async function getUserDetails(username) {
      try {
        const response = await octokit.request("GET /users/:username", {
          username: username,
        });
        return response.data;
      } catch (error) {
        console.error(`Error fetching user details for ${username}:`, error);
        return null;
      }
    }

    octokit
      .request("GET /repos/:owner/:repo/contributors", {
        owner: "jineshnagori",
        repo: "DevBlog",
      })
      .then(async (response) => {
        const contributorsHtml = await Promise.all(
          response.data.map(async (user) => {
            const userDetails = await getUserDetails(user.login);
            const bio =
              userDetails?.bio || "Developer and open source contributor";
            const name = userDetails?.name || user.login;
            const location = userDetails?.location || "";
            const company = userDetails?.company || "";

            return `
              <div class="col-lg-3 col-md-4 col-sm-6">
                <div class="contributor-card" onclick="toggleFlip(this)">
                  <div class="contributor-card-inner">
                    <div class="contributor-card-front">
                      <img src="${
                        user.avatar_url
                      }" class="rounded-circle p-3" style="width: 120px; height: 120px; object-fit: cover;" alt="${
              user.login
            }">
                      <div class="text-center p-3">
                        <h5 class="mb-2">${name}</h5>
                        <p class="text-muted mb-2">@${user.login}</p>
                        <p class="text-primary fw-bold">${
                          user.contributions
                        } contributions</p>
                      </div>
                    </div>
                    <div class="contributor-card-back">
                      <div class="text-center h-100 d-flex flex-column justify-content-center">
                        <img src="${
                          user.avatar_url
                        }" class="rounded-circle mb-3 mx-auto" style="width: 80px; height: 80px; object-fit: cover;" alt="${
              user.login
            }">
                        <h6 class="mb-2">${name}</h6>
                        <p class="small text-muted mb-2">${bio}</p>
                        ${
                          location
                            ? `<p class="small mb-1"><i class="fas fa-map-marker-alt me-1"></i>${location}</p>`
                            : ""
                        }
                        ${
                          company
                            ? `<p class="small mb-2"><i class="fas fa-building me-1"></i>${company}</p>`
                            : ""
                        }
                        <a href="${
                          user.html_url
                        }" target="_blank" class="btn btn-primary btn-sm mt-2">
                          <i class="fab fa-github me-1"></i>View Profile
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>`;
          })
        );

        document.getElementById("contributors-container").innerHTML =
          contributorsHtml.join("");
      });

    function toggleFlip(card) {
      if (window.innerWidth <= 768) {
        card.classList.toggle("flipped");
      }
    }

    document.addEventListener("DOMContentLoaded", function () {
      document.addEventListener("click", function (e) {
        if (
          window.innerWidth <= 768 &&
          !e.target.closest(".contributor-card")
        ) {
          document
            .querySelectorAll(".contributor-card.flipped")
            .forEach((card) => {
              card.classList.remove("flipped");
            });
        }
      });
    });

    window.toggleFlip = toggleFlip;
  </script>
</html>
